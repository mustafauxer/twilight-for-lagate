/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js":
/*!********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js ***!
  \********************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _assertThisInitialized)
/* harmony export */ });
function _assertThisInitialized(e) {
  if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  return e;
}


/***/ }),

/***/ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/classCallCheck.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/classCallCheck.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _classCallCheck)
/* harmony export */ });
function _classCallCheck(a, n) {
  if (!(a instanceof n)) throw new TypeError("Cannot call a class as a function");
}


/***/ }),

/***/ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/createClass.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/createClass.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _createClass)
/* harmony export */ });
/* harmony import */ var _toPropertyKey_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./toPropertyKey.js */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js");

function _defineProperties(e, r) {
  for (var t = 0; t < r.length; t++) {
    var o = r[t];
    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, (0,_toPropertyKey_js__WEBPACK_IMPORTED_MODULE_0__["default"])(o.key), o);
  }
}
function _createClass(e, r, t) {
  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", {
    writable: !1
  }), e;
}


/***/ }),

/***/ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _getPrototypeOf)
/* harmony export */ });
function _getPrototypeOf(t) {
  return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) {
    return t.__proto__ || Object.getPrototypeOf(t);
  }, _getPrototypeOf(t);
}


/***/ }),

/***/ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/inherits.js":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/inherits.js ***!
  \*******************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _inherits)
/* harmony export */ });
/* harmony import */ var _setPrototypeOf_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./setPrototypeOf.js */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js");

function _inherits(t, e) {
  if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function");
  t.prototype = Object.create(e && e.prototype, {
    constructor: {
      value: t,
      writable: !0,
      configurable: !0
    }
  }), Object.defineProperty(t, "prototype", {
    writable: !1
  }), e && (0,_setPrototypeOf_js__WEBPACK_IMPORTED_MODULE_0__["default"])(t, e);
}


/***/ }),

/***/ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _possibleConstructorReturn)
/* harmony export */ });
/* harmony import */ var _typeof_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./typeof.js */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/typeof.js");
/* harmony import */ var _assertThisInitialized_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./assertThisInitialized.js */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js");


function _possibleConstructorReturn(t, e) {
  if (e && ("object" == (0,_typeof_js__WEBPACK_IMPORTED_MODULE_0__["default"])(e) || "function" == typeof e)) return e;
  if (void 0 !== e) throw new TypeError("Derived constructors may only return object or undefined");
  return (0,_assertThisInitialized_js__WEBPACK_IMPORTED_MODULE_1__["default"])(t);
}


/***/ }),

/***/ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _setPrototypeOf)
/* harmony export */ });
function _setPrototypeOf(t, e) {
  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {
    return t.__proto__ = e, t;
  }, _setPrototypeOf(t, e);
}


/***/ }),

/***/ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/toPrimitive.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/toPrimitive.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ toPrimitive)
/* harmony export */ });
/* harmony import */ var _typeof_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./typeof.js */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/typeof.js");

function toPrimitive(t, r) {
  if ("object" != (0,_typeof_js__WEBPACK_IMPORTED_MODULE_0__["default"])(t) || !t) return t;
  var e = t[Symbol.toPrimitive];
  if (void 0 !== e) {
    var i = e.call(t, r || "default");
    if ("object" != (0,_typeof_js__WEBPACK_IMPORTED_MODULE_0__["default"])(i)) return i;
    throw new TypeError("@@toPrimitive must return a primitive value.");
  }
  return ("string" === r ? String : Number)(t);
}


/***/ }),

/***/ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ toPropertyKey)
/* harmony export */ });
/* harmony import */ var _typeof_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./typeof.js */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/typeof.js");
/* harmony import */ var _toPrimitive_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./toPrimitive.js */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/toPrimitive.js");


function toPropertyKey(t) {
  var i = (0,_toPrimitive_js__WEBPACK_IMPORTED_MODULE_1__["default"])(t, "string");
  return "symbol" == (0,_typeof_js__WEBPACK_IMPORTED_MODULE_0__["default"])(i) ? i : i + "";
}


/***/ }),

/***/ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/typeof.js":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/typeof.js ***!
  \*****************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ _typeof)
/* harmony export */ });
function _typeof(o) {
  "@babel/helpers - typeof";

  return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) {
    return typeof o;
  } : function (o) {
    return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o;
  }, _typeof(o);
}


/***/ }),

/***/ "./src/assets/js/base-page.js":
/*!************************************!*\
  !*** ./src/assets/js/base-page.js ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/classCallCheck.js");
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/createClass.js");


var BasePage = /*#__PURE__*/function () {
  function BasePage() {
    (0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__["default"])(this, BasePage);
  }
  return (0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__["default"])(BasePage, [{
    key: "onReady",
    value: function onReady() {
      //
    }
  }, {
    key: "registerEvents",
    value: function registerEvents() {
      //
    }

    /**
     * To avoid loading unwanted classes, unless it's wanted page
     * @param {null|string[]} allowedPages
     * @return {*}
     */
  }, {
    key: "initiate",
    value: function initiate(allowedPages) {
      if (allowedPages && !allowedPages.includes(salla.config.get('page.slug'))) {
        return app.log("The Class For (".concat(allowedPages.join(','), ") Skipped."));
      }
      this.onReady();
      this.registerEvents();
      app.log("The Class For (".concat((allowedPages === null || allowedPages === void 0 ? void 0 : allowedPages.join(',')) || '*', ") Loaded\uD83C\uDF89"));
    }
  }]);
}();
/**
 * Because we merged multi classes into one file, there is no need to initiate all of them
 */
BasePage.initiateWhenReady = function () {
  var _window$app,
    _this = this;
  var allowedPages = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
  if (((_window$app = window.app) === null || _window$app === void 0 ? void 0 : _window$app.status) === 'ready') {
    new this().initiate(allowedPages);
  } else {
    document.addEventListener('theme::ready', function () {
      return new _this().initiate(allowedPages);
    });
  }
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (BasePage);

/***/ }),

/***/ "./src/assets/js/partials/validate-product-options.js":
/*!************************************************************!*\
  !*** ./src/assets/js/partials/validate-product-options.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   validateProductOptions: () => (/* binding */ validateProductOptions)
/* harmony export */ });
/**
 * Validates product options for items in the cart.
 */
function validateProductOptions() {
  var cartItems = document.querySelectorAll('.main-content form:not(.cart-options form)');
  if (!cartItems.length) return;
  cartItems.forEach(function (item) {
    var itemId = getItemId(item);
    var productOptions = item.querySelector('salla-product-options');
    var quantityComponent = item.querySelector('salla-quantity-input');
    if (quantityComponent) {
      observeQuantityChanges(quantityComponent, itemId, item);
    }

    // Listen for product options changes
    if (productOptions) {
      productOptions.addEventListener('changed', function (e) {
        setTimeout(function () {
          var _e$detail, _e$detail2;
          if (!item.reportValidity() || ((_e$detail = e.detail) === null || _e$detail === void 0 || (_e$detail = _e$detail.event) === null || _e$detail === void 0 ? void 0 : _e$detail.type) == 'added') return;
          if (Number(itemId) === Number((_e$detail2 = e.detail) === null || _e$detail2 === void 0 ? void 0 : _e$detail2.productId)) {
            var _e$detail3;
            appendLoadingOverlay((_e$detail3 = e.detail) === null || _e$detail3 === void 0 ? void 0 : _e$detail3.productId);
          }
        }, 100);
      });
    }
  });

  // Event handlers for cart updates
  salla.cart.event.onItemUpdated(function (_data, id) {
    removeLoadingOverlay(id);
  });
  salla.cart.event.onItemUpdatedFailed(function (_data, itemId) {
    handleCartUpdateFailure(itemId, cartItems);
  });
}

/**
 * Observes changes in quantity input for a specific cart item.
 */
function observeQuantityChanges(quantityComponent, itemId, item) {
  var observer = new MutationObserver(function () {
    var quantityInput = quantityComponent.querySelector('input[name="quantity"]');
    if (quantityInput) {
      observer.disconnect(); // Stop observing once input is found
      quantityInput.addEventListener('change', function (e) {
        var _e$detail4;
        if (!item.reportValidity()) return;
        if (Number(itemId) === Number((_e$detail4 = e.detail) === null || _e$detail4 === void 0 ? void 0 : _e$detail4.productId)) {
          var _e$detail5;
          appendLoadingOverlay((_e$detail5 = e.detail) === null || _e$detail5 === void 0 ? void 0 : _e$detail5.productId);
        }
      });
    }
  });
  observer.observe(quantityComponent, {
    childList: true,
    subtree: true
  });
}

/**
 * Handles cart update failures by restoring the item state.
 */
function handleCartUpdateFailure(itemId, cartItems) {
  return salla.api.cart.getCurrentCartId(false, "salla-product-options").then(function (cartId) {
    return salla.cart.details(cartId, ['options']);
  }).then(function (_ref) {
    var cartDetails = _ref.data.cart;
    var currentProduct = cartDetails.items.find(function (item) {
      return Number(item.id) === Number(itemId);
    });
    if (!currentProduct) throw new Error("Product with ID ".concat(itemId, " not found in cart details."));
    updateCartItemState(cartItems, currentProduct);
  }).then(function () {
    return removeLoadingOverlay();
  })["catch"](function (error) {
    console.error("Error restoring cart item state:", error);
    removeLoadingOverlay();
  });
}

/**
 * Updates the UI for a specific cart item based on its current state.
 */
function updateCartItemState(cartItems, currentProduct) {
  cartItems.forEach(function (item) {
    var ID = getItemId(item);
    if (Number(currentProduct.id) === Number(ID)) {
      var productOptions = item.querySelector('salla-product-options');
      var quantityInput = item.querySelector('salla-quantity-input');
      if (productOptions) productOptions.setOptionsData(currentProduct.options, false);
      if (quantityInput) quantityInput.setValue(currentProduct.quantity, false);
    }
  });
}

/**
 * Appends a loading overlay to the cart item with the given ID.
 */
function appendLoadingOverlay(itemId) {
  if (!itemId) return;
  var loadingOverlay = createLoadingOverlay();
  var parentElement = document.querySelector("#item-".concat(itemId, " .cart-item"));
  if (parentElement) {
    parentElement.appendChild(loadingOverlay);
  }
}

/**
 * Removes the loading overlay from a specific cart item or all items if no ID is provided.
 */
function removeLoadingOverlay(itemId) {
  var targetItems = itemId ? [document.querySelector(".main-content form:not(.cart-options form)#item-".concat(itemId, " .cart-item"))] : document.querySelectorAll('.main-content form:not(.cart-options form) .cart-item');
  targetItems.forEach(function (item) {
    var loadingOverlay = item === null || item === void 0 ? void 0 : item.querySelector('.loading-overlay');
    if (loadingOverlay) {
      setTimeout(function () {
        return loadingOverlay.remove();
      }, 0);
    }
  });
}

/**
 * Creates a loading overlay element.
 */
function createLoadingOverlay() {
  var overlay = document.createElement('div');
  overlay.classList.add('loading-overlay', 'absolute', 'inset-0', 'z-50', 'flex', 'justify-center', 'items-center');
  var background = document.createElement('div');
  background.classList.add('absolute', 'inset-0', 'bg-white', 'opacity-40');
  var loader = document.createElement('div');
  loader.innerHTML = '<salla-loading size="32"></salla-loading>';
  loader.classList.add('relative', 'z-10');
  overlay.appendChild(background);
  overlay.appendChild(loader);
  return overlay;
}

/**
 * Extracts the item ID from a cart item element.
 */
function getItemId(item) {
  var _item$querySelector;
  return (_item$querySelector = item.querySelector('input[type="hidden"][name="id"]')) === null || _item$querySelector === void 0 ? void 0 : _item$querySelector.value;
}

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry needs to be wrapped in an IIFE because it needs to be isolated against other entry modules.
(() => {
var __webpack_exports__ = {};
/*!*******************************!*\
  !*** ./src/assets/js/cart.js ***!
  \*******************************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/classCallCheck.js");
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/createClass.js");
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js");
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js");
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/inherits.js");
/* harmony import */ var _base_page__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./base-page */ "./src/assets/js/base-page.js");
/* harmony import */ var _partials_validate_product_options__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./partials/validate-product-options */ "./src/assets/js/partials/validate-product-options.js");





function _callSuper(t, o, e) { return o = (0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__["default"])(o), (0,_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__["default"])(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], (0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__["default"])(t).constructor) : o.apply(t, e)); }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }


var Cart = /*#__PURE__*/function (_BasePage) {
  function Cart() {
    (0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__["default"])(this, Cart);
    return _callSuper(this, Cart, arguments);
  }
  (0,_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__["default"])(Cart, _BasePage);
  return (0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__["default"])(Cart, [{
    key: "onReady",
    value: function onReady() {
      var _this = this;
      // keep update the dom base in the events
      salla.event.cart.onUpdated(function (data) {
        return _this.updateCartPageInfo(data);
      });
      app.watchElements({
        couponCodeInput: '#coupon-input',
        couponBtn: '#coupon-btn',
        couponError: '#coupon-error',
        subTotal: '#sub-total',
        orderOptionsTotal: '#cart-options-total',
        totalDiscount: '#total-discount',
        taxAmount: '#tax-amount',
        shippingCost: '#shipping-cost',
        freeShipping: '#free-shipping',
        freeShippingBar: '#free-shipping-bar',
        freeShippingMsg: '#free-shipping-msg',
        freeShipApplied: '#free-shipping-applied',
        cartGifting: '#cart-gifting',
        sallaGifting: '#salla-gifting'
      });
      this.initiateCoupon();
      this.initSubmitCart();
      (0,_partials_validate_product_options__WEBPACK_IMPORTED_MODULE_6__.validateProductOptions)();
    }
  }, {
    key: "initSubmitCart",
    value: function initSubmitCart() {
      var submitBtn = document.querySelector('#cart-submit');
      if (!submitBtn) {
        return;
      }
      app.onClick(submitBtn, function (event) {
        var cartForms = document.querySelectorAll('form[id^="item-"]');
        var isValid = true;
        cartForms.forEach(function (form) {
          isValid = isValid && form.reportValidity();
          if (!isValid) {
            event.preventDefault();
            salla.notify.error(salla.lang.get('common.messages.required_fields'));
            return;
          }
        });
        if (isValid) {
          /** @type HTMLSallaButtonElement */
          var btn = event.currentTarget;
          salla.config.get('user.type') == 'guest' ? salla.cart.submit() : btn.load().then(function () {
            return salla.cart.submit();
          });
        }
      });
    }
  }, {
    key: "updateCartOptions",
    value: function updateCartOptions(options) {
      var _document$querySelect;
      if (!options || !options.length) return;
      var arrayTwoId = options.map(function (item) {
        return item.id;
      });
      (_document$querySelect = document.querySelectorAll('.cart-options form')) === null || _document$querySelect === void 0 || _document$querySelect.forEach(function (form) {
        if (!arrayTwoId.includes(form.id.value)) {
          form.remove();
        }
      });
    }

    /**
     * @param {import("@salla.sa/twilight/types/api/cart").CartSummary} cartData
     */
  }, {
    key: "updateCartPageInfo",
    value: function updateCartPageInfo(cartData) {
      var _app$sallaGifting,
        _cartData$gift2,
        _app$sallaGifting2,
        _cartData$gift3,
        _cartData$items,
        _this2 = this;
      //if item deleted & there is no more items, just reload the page
      if (!cartData.count) {
        var _document$querySelect2;
        // clear cart options from the dom before page reload
        (_document$querySelect2 = document.querySelector('.cart-options')) === null || _document$querySelect2 === void 0 || _document$querySelect2.remove();
        return window.location.reload();
      }
      // toggle physical gifting depned on giftable flag
      app.toggleElementClassIf(app.cartGifting, 'active', 'hidden', function () {
        var _cartData$gift;
        return cartData === null || cartData === void 0 || (_cartData$gift = cartData.gift) === null || _cartData$gift === void 0 ? void 0 : _cartData$gift.enabled;
      });
      // Use toggleAttribute to handle the `physical-products` attribute
      (_app$sallaGifting = app.sallaGifting) === null || _app$sallaGifting === void 0 || _app$sallaGifting.toggleAttribute('physical-products', (cartData === null || cartData === void 0 || (_cartData$gift2 = cartData.gift) === null || _cartData$gift2 === void 0 ? void 0 : _cartData$gift2.type) === 'physical');
      (_app$sallaGifting2 = app.sallaGifting) === null || _app$sallaGifting2 === void 0 || _app$sallaGifting2.toggleAttribute('digital-products', (cartData === null || cartData === void 0 || (_cartData$gift3 = cartData.gift) === null || _cartData$gift3 === void 0 ? void 0 : _cartData$gift3.type) === 'digital');

      // update the dom for cart options
      this.updateCartOptions(cartData === null || cartData === void 0 ? void 0 : cartData.options);
      // update each item data
      (_cartData$items = cartData.items) === null || _cartData$items === void 0 || _cartData$items.forEach(function (item) {
        return _this2.updateItemInfo(item);
      });
      app.subTotal.innerHTML = salla.money(cartData.sub_total);
      if (app.taxAmount) app.taxAmount.innerHTML = salla.money(cartData.tax_amount);
      if (app.orderOptionsTotal) app.orderOptionsTotal.innerHTML = salla.money(cartData.options_total);
      app.toggleElementClassIf(app.totalDiscount, 'discounted', 'hidden', function () {
        return !!cartData.total_discount;
      }).toggleElementClassIf(app.shippingCost, 'has_shipping', 'hidden', function () {
        var _cartData$free_shippi;
        return !!cartData.real_shipping_cost && !((_cartData$free_shippi = cartData.free_shipping_bar) !== null && _cartData$free_shippi !== void 0 && _cartData$free_shippi.has_free_shipping);
      }).toggleElementClassIf(app.freeShipping, 'has_free', 'hidden', function () {
        return !!cartData.free_shipping_bar;
      });
      app.totalDiscount.querySelector('b').innerHTML = '- ' + salla.money(cartData.total_discount);
      app.shippingCost.querySelector('b').innerHTML = salla.money(cartData.real_shipping_cost);
      if (!cartData.free_shipping_bar) {
        return;
      }
      var isFree = cartData.free_shipping_bar.has_free_shipping;
      app.toggleElementClassIf(app.freeShippingBar, 'active', 'hidden', function () {
        return !isFree;
      }).toggleElementClassIf(app.freeShipApplied, 'active', 'hidden', function () {
        return isFree;
      });
      app.freeShippingMsg.innerHTML = isFree ? salla.lang.get('pages.cart.has_free_shipping') : salla.lang.get('pages.cart.free_shipping_alert', {
        amount: salla.money(cartData.free_shipping_bar.remaining)
      });
      app.freeShippingBar.children[0].style.width = cartData.free_shipping_bar.percent + '%';
    }

    /**
     * @param {import("@salla.sa/twilight/types/api/cart").CartItem} item
     */
  }, {
    key: "updateItemInfo",
    value: function updateItemInfo(item) {
      var _item$detailed_offers, _item$detailed_offers2;
      // lets get the elements for this item
      var cartItem = document.querySelector('#item-' + item.id);
      if (!cartItem) {
        salla.log("Can't get the cart item dom for ".concat(item.id, "!"));
        return;
      }
      var totalElement = cartItem.querySelector('.item-total'),
        priceElement = cartItem.querySelector('.item-price'),
        regularPriceElement = cartItem.querySelector('.item-regular-price'),
        itemOriginalPrice = cartItem.querySelector('.item-original-price'),
        offerElement = cartItem.querySelector('.offer-name'),
        oldOffers = cartItem.querySelector('.old-offers'),
        freeRibbon = cartItem.querySelector('.free-ribbon'),
        offerIconElement = cartItem.querySelector('.offer-icon'),
        hasSpecialPrice = item.offer || item.special_price > 0,
        hasSalePrice = item.is_on_sale,
        newOffersActive = ((_item$detailed_offers = item.detailed_offers) === null || _item$detailed_offers === void 0 ? void 0 : _item$detailed_offers.length) > 0;
      var item_total = ((_item$detailed_offers2 = item.detailed_offers) === null || _item$detailed_offers2 === void 0 ? void 0 : _item$detailed_offers2.length) > 0 ? item.total_special_price : item.total;
      var total = salla.money(item_total);
      if (total !== totalElement.innerHTML) {
        totalElement.innerHTML = total;
        app.anime(totalElement, {
          scale: [.88, 1]
        });
      }
      app.toggleElementClassIf([offerElement, oldOffers], 'offer-applied', 'hidden', function () {
        return hasSpecialPrice && !newOffersActive;
      }).toggleElementClassIf([regularPriceElement, offerIconElement], 'offer-applied', 'hidden', function () {
        return hasSpecialPrice;
      }).toggleElementClassIf([itemOriginalPrice], 'offer-applied', 'hidden', function () {
        return hasSalePrice;
      }).toggleElementClassIf(priceElement, 'text-red-400', 'text-sm text-gray-400', function () {
        return hasSpecialPrice;
      }).toggleElementClassIf(freeRibbon, 'active', 'hidden', function () {
        return item.price == 0;
      });
      priceElement.innerHTML = salla.money(item.price);
      if (!hasSpecialPrice) {
        return;
      }
      if (!newOffersActive) {
        offerElement.innerHTML = item.offer.names;
      }
      itemOriginalPrice.innerHTML = salla.money(item.original_price);
      regularPriceElement.innerHTML = salla.money(item.product_price);
    }
    //=================== Coupon Method ========================//
  }, {
    key: "initiateCoupon",
    value: function initiateCoupon() {
      var _this3 = this;
      if (!app.couponCodeInput) {
        return;
      }
      app.onKeyUp(app.couponCodeInput, function (event) {
        event.keyCode === 13 && app.couponBtn.click();
        app.couponError.value = '';
        app.removeClass(app.couponCodeInput, 'has-error');
      });
      app.onClick(app.couponBtn, function (event) {
        //if it's remove coupon, will have `btn--danger` class
        var hasCoupon = app.couponBtn.classList.contains('btn--danger');
        /** @type HTMLSallaButtonElement */
        var btn = event.currentTarget;
        if (!hasCoupon && !app.couponCodeInput.value.length) {
          _this3.showCouponError('* ' + salla.lang.get('pages.checkout.enter_coupon'));
          return;
        }
        btn.load().then(function () {
          return hasCoupon ? salla.cart.deleteCoupon() : salla.cart.addCoupon(app.couponCodeInput.value);
        }).then(function (res) {
          return _this3.toggleCoupon(res, !hasCoupon);
        })["catch"](function (err) {
          var _err$response;
          return _this3.showCouponError((_err$response = err.response) === null || _err$response === void 0 || (_err$response = _err$response.data) === null || _err$response === void 0 ? void 0 : _err$response.error.message, !hasCoupon);
        })["finally"](function () {
          return btn.stop();
        });
      });
    }

    /**
     * @param {CartResponse.update} res
     * @param {boolean} applied
     */
  }, {
    key: "toggleCoupon",
    value: function toggleCoupon(_res, applied) {
      app.couponError.innerText = '';
      app.couponCodeInput.value = applied ? app.couponCodeInput.value : '';
      app.couponCodeInput.toggleAttribute('disabled', applied);
      app.toggleElementClassIf(app.couponBtn, ['btn--danger', 'has-coupon'], ['btn-default', 'has-not-coupon'], function () {
        return applied;
      }).toggleElementClassIf(app.couponBtn, ['btn-default', 'has-not-coupon'], ['btn--danger', 'has-coupon'], function () {
        return !applied;
      }).hideElement(app.couponBtn.querySelector(applied ? 'span' : 'i')).showElement(app.couponBtn.querySelector(applied ? 'i' : 'span')).removeClass(app.couponCodeInput, 'has-error');
    }
  }, {
    key: "showCouponError",
    value: function showCouponError(message) {
      var isApplying = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
      app.couponError.innerText = message || salla.lang.get('pages.checkout.error_occurred');
      isApplying ? app.addClass(app.couponCodeInput, 'has-error') : null;
    }
  }]);
}(_base_page__WEBPACK_IMPORTED_MODULE_5__["default"]);
Cart.initiateWhenReady(['cart']);
})();

// This entry needs to be wrapped in an IIFE because it needs to be isolated against other entry modules.
(() => {
/*!***********************************!*\
  !*** ./src/assets/js/thankyou.js ***!
  \***********************************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/classCallCheck.js");
/* harmony import */ var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/createClass.js");
/* harmony import */ var _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js");
/* harmony import */ var _babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js");
/* harmony import */ var _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/.pnpm/@babel+runtime@7.26.10/node_modules/@babel/runtime/helpers/esm/inherits.js");
/* harmony import */ var _base_page__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./base-page */ "./src/assets/js/base-page.js");





function _callSuper(t, o, e) { return o = (0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__["default"])(o), (0,_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__["default"])(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], (0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__["default"])(t).constructor) : o.apply(t, e)); }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }

var ThankYou = /*#__PURE__*/function (_BasePage) {
  function ThankYou() {
    (0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__["default"])(this, ThankYou);
    return _callSuper(this, ThankYou, arguments);
  }
  (0,_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4__["default"])(ThankYou, _BasePage);
  return (0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__["default"])(ThankYou, [{
    key: "onReady",
    value: function onReady() {
      app.anime('.thanks-item', {
        translateX: [20, 0]
      });
      var form = document.querySelector('#invoice-form');
      salla.order.event.onInvoiceSent(function (res) {
        form.innerHTML = res.data.message;
        form.classList.add('sent');
      });
    }
  }]);
}(_base_page__WEBPACK_IMPORTED_MODULE_5__["default"]);
ThankYou.initiateWhenReady(['thank-you']);
})();

/******/ })()
;
//# sourceMappingURL=checkout.js.map